version: "3.9"

services:
  notifier_api:
    container_name: notifier_api
    build:
      context: .
      dockerfile: Dockerfile
    env_file:
      - .env
    environment:
      MAIN_IP: "0.0.0.0"
      PORT: "8098"

      # CORS: main.py nimmt NOTIFIER_CORS_ORIGINS zuerst, dann REGISTRY..., dann IND_PROXY...
      NOTIFIER_CORS_ORIGINS: "http://localhost:8050,http://127.0.0.1:8050"

      # Optional: falls du registry_api.py per Datei nachladen willst
      # REGISTRY_API_FILE: "/app/api/registry_api.py"

      # Optional, aber sinnvoll: Lock dir fix setzen
      NOTIFIER_LOCK_DIR: "/app/data/locks"
    volumes:
      # Persist result JSONs / whatever config.py benutzt
      - ./data:/app/data
    ports:
      - "8098:8098"
    restart: unless-stopped
